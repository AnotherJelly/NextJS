'use client';

import React, { useEffect, useState } from "react";
import Cookies from "js-cookie";
import Link from "next/link";

interface Lesson {
  id: number;
  title: string;
  description: string;
  content: string;
  task: string;
  correctAnswer: string;
}

interface Params {
  id: string;
}

const lessonsData: Lesson[] = [
    {
        "id": 1,
        "title": "Что такое SEO?",
        "description": "Что такое SEO, почему оно важно для продвижения сайтов и какие преимущества дает использование методов поисковой оптимизации.",
        "content": `
            <p>SEO (Search Engine Optimization) — это процесс оптимизации сайта с целью повышения его видимости в результатах поисковых систем. Основная цель SEO — сделать так, чтобы пользователи могли легко находить ваш сайт по релевантным запросам.</p>
            
            <h2>Почему SEO важно?</h2>
            <ul>
                <li><strong>Привлечение органического трафика:</strong> Люди чаще кликают на сайты, которые находятся в верхней части поисковой выдачи.</li>
                <li><strong>Повышение доверия:</strong> Сайты, находящиеся в топе поисковых систем, ассоциируются с высоким качеством.</li>
                <li><strong>Экономичность:</strong> В отличие от платной рекламы, органический трафик не требует постоянных затрат.</li>
            </ul>

            <h2>Основные составляющие SEO</h2>
            <ol>
                <li><strong>Техническое SEO:</strong> Обеспечивает правильную работу сайта (скорость загрузки, адаптивность, безопасность).</li>
                <li><strong>Контент:</strong> Информативный и полезный текст, соответствующий запросам пользователей.</li>
                <li><strong>Ссылки:</strong> Внешние и внутренние ссылки, которые помогают улучшить позиции сайта.</li>
            </ol>

            <h2>Ключевые термины</h2>
            <ul>
                <li><strong>Поисковая выдача (SERP):</strong> Страница с результатами поиска.</li>
                <li><strong>Ключевые слова:</strong> Запросы, по которым пользователи находят сайт.</li>
                <li><strong>Индексация:</strong> Процесс добавления страниц сайта в базу поисковой системы.</li>
            </ul>
        `,
        "task" : "Дайте определение SEO одним предложением.",
        "correctAnswer" : `это процесс оптимизации сайта с целью повышения его видимости в результатах поисковых систем`
    },
    {
        "id": 2,
        "title": "Как работают поисковые системы?",
        "description": "Как поисковые системы собирают, анализируют и показывают информацию пользователям. Ключевые этапы работы поисковых систем и их значимость для SEO.",
        "content": `
            <p>Поисковые системы — это сложные программы, которые помогают находить информацию в интернете. Они работают в три этапа:</p>
    
            <h2>Три этапа работы поисковых систем</h2>
            <ol>
                <li><strong>Кроулинг (Crawling):</strong> Роботы (боты) поисковых систем сканируют веб-страницы, переходя по ссылкам, чтобы найти новый или обновленный контент.</li>
                <li><strong>Индексация (Indexing):</strong> После сканирования информация о веб-страницах сохраняется в базе данных поисковой системы (индекс), чтобы она могла быть найдена по запросу.</li>
                <li><strong>Ранжирование (Ranking):</strong> Когда пользователь вводит запрос, поисковая система оценивает релевантность страниц в индексе и показывает их в порядке убывания полезности.</li>
            </ol>

            <h2>Файл robots.txt</h2>
            <p>Файл <code>robots.txt</code> используется для управления доступом поисковых систем к вашему сайту. С его помощью вы можете:</p>
            <ul>
                <li>Разрешить или запретить индексацию отдельных страниц или разделов сайта.</li>
                <li>Указать поисковым ботам, какие страницы нужно игнорировать.</li>
            </ul>
            <p>Пример содержимого файла, который запрещает индексацию всего сайта:</p>
            <pre>User-agent: *<br>Disallow: /</pre>
        `,
        "task" : ` Напишите команду, которая запрещает всем поисковым системам индексацию сайта в файле robots.txt.`,
        "correctAnswer" : "User-agent: *\nDisallow: /"
    },
    {
        "id": 3,
        "title": "Техническое SEO",
        "description": "Важность технического SEO для улучшения видимости сайта в поисковых системах.",
        "content": `
            <p>Техническое SEO включает в себя оптимизацию структуры сайта, его скорости и других факторов, которые помогают поисковым системам лучше индексировать и отображать страницы сайта. Основные задачи технического SEO:</p>
            <ul>
                <li><strong>Ускорение загрузки страницы:</strong> Быстрая загрузка важна как для пользователей, так и для поисковых систем.</li>
                <li><strong>Мобильная адаптация:</strong> Сайт должен быть оптимизирован для мобильных устройств, так как большинство пользователей используют мобильные телефоны для поиска.</li>
                <li><strong>Правильная структура URL:</strong> Чистые, логичные и короткие URL-адреса помогают поисковым системам лучше понимать контент страницы.</li>
                <li><strong>Использование HTTPS:</strong> Защищенный протокол HTTPS необходим для безопасности пользователей и для улучшения позиций в поисковой выдаче.</li>
            </ul>

            <h2>Заголовок страницы и его роль в SEO</h2>
            <p>Одним из важных элементов страницы, с точки зрения SEO, является <strong>тег <code>&lt;title&gt;</code></strong>. Это название страницы, которое отображается в поисковой выдаче и вкладке браузера. Хороший заголовок должен:</p>
            <ul>
                <li>Включать ключевые слова, по которым пользователи могут искать ваш сайт.</li>
                <li>Содержать название компании или бренда, чтобы пользователи могли легко идентифицировать сайт.</li>
                <li>Быть кратким и точным, обычно до 60 символов, чтобы он полностью отображался в поисковой выдаче.</li>
            </ul>

            <h2>Пример заголовка</h2>
            <p>Вот пример заголовка, который соответствует правилам SEO:</p>
            <pre>&lt;title&gt;Купить авто недорого - Автосалон «Тачки»&lt;/title&gt;</pre>
            <p>Этот заголовок включает ключевое слово "Купить авто недорого" и название компании "Автосалон «Тачки»", что помогает пользователям и поисковым системам понять содержание страницы.</p>
        `,
        "task" : ` Напишите пример заголовка HTML страницы, который соответствует правилам SEO для компании Магазин Техно, которая занимается продажей ноутбуков. `,
        "correctAnswer" : "<title>Купить ноутбук недорого - Магазин Техно</title>"
    },
    {
        "id": 4,
        "title": "Внутренняя оптимизация сайта",
        "description": "Важные аспекты внутренней оптимизации сайта, которые помогают улучшить видимость страниц в поисковых системах и сделать сайт более удобным для пользователей.",
        "content": `
            <p>Внутренняя оптимизация сайта (on-page SEO) включает в себя различные элементы, которые можно контролировать непосредственно на странице. Это факторы, влияющие на то, как поисковые системы воспринимают и индексируют страницы вашего сайта.</p>
            <p>Основные элементы внутренней оптимизации:</p>
            <ul>
                <li><strong>Мета-теги:</strong> Мета-тег <code>&lt;meta name="description"&gt;</code> помогает поисковым системам и пользователям понять, о чем страница. Это краткое описание, которое часто показывается в результатах поиска.</li>
                <li><strong>Заголовки:</strong> Правильное использование заголовков <code>&lt;h1&gt;</code>, <code>&lt;h2&gt;</code> и других помогает организовать структуру страницы и улучшить ее читаемость.</li>
                <li><strong>Оптимизация контента:</strong> Контент на странице должен быть уникальным, качественным и соответствовать запросам пользователей.</li>
                <li><strong>Изображения:</strong> Все изображения должны иметь правильные атрибуты <code>alt</code> и быть оптимизированы для скорости загрузки.</li>
            </ul>

            <h2>Мета-описание</h2>
            <p>Мета-описание — это краткое описание содержимого страницы, которое отображается в поисковой выдаче под заголовком. Хорошее мета-описание должно быть:</p>
            <ul>
                <li>Информативным и точным.</li>
                <li>Включать ключевые слова, связанные с содержанием страницы.</li>
                <li>Не превышать 160 символов, чтобы описание полностью отображалось в поисковой выдаче.</li>
            </ul>

            <h2>Пример мета-описания</h2>
            <p>Вот пример корректного мета-описания для страницы товара:</p>
            <pre>&lt;meta name="description" content="Купить авто недорого в автосалоне «Тачки». Гарантия и низкие цены!"&gt;</pre>
            <p>Это описание включает ключевые слова "купить авто", "недорого", "автосалон «Тачки»" и привлекает внимание пользователя, подчеркивая преимущества (гарантия, низкие цены).</p>
        `,
        "task" : ` Напишите корректное мета-описание для страницы ноутбука в магазине Техно. Не забудьте указать преимущества. `,
        "correctAnswer" : `<meta name="description" content="Купить ноутбук недорого в магазине Техно. Гарантия и низкие цены!">`
    },
    {
        "id": 5,
        "title": "Работа с контентом",
        "description": "Как правильно работать с контентом на странице, включая оптимизацию текста для SEO.",
        "content": `
            <p>Контент на сайте включает в себя текст, изображения, видео и другие элементы, которые пользователи видят на странице. Важность контента в SEO неоспорима — он помогает поисковым системам понять, о чем ваш сайт, и предоставляет пользователям полезную информацию.</p>
            <p>Контент должен быть:</p>
            <ul>
                <li><strong>Уникальным:</strong> Поисковые системы ценят уникальный контент и могут понижать позиции сайтов с дублированным содержанием.</li>
                <li><strong>Полезным и информативным:</strong> Контент должен решать задачи пользователей, отвечать на их вопросы и быть понятным.</li>
                <li><strong>Оптимизированным:</strong> В контенте нужно использовать ключевые слова, которые соответствуют запросам пользователей, но без перенасыщения.</li>
            </ul>

            <h2>Как использовать ключевые слова?</h2>
            <p>Ключевые слова — это те слова и фразы, которые пользователи вводят в поисковики. Важно использовать ключевые слова в контенте страницы, но делать это естественно и без перегрузки. Один из способов использования — включить ключевое слово в абзац текста, например, в описаниях товаров или услуг.</p>

            <h2>Пример использования ключевого слова</h2>
            <p>Вот пример HTML-кода абзаца с текстом, в котором используется ключевое слово "лучшие автомобили":</p>
            <pre>&lt;p&gt;У нас вы найдете лучшие автомобили по отличным ценам.&lt;/p&gt;</pre>
            <p>Здесь ключевое слово "лучшие автомобили" используется в контексте, что помогает поисковым системам лучше понять содержание страницы.</p>
        `,
        "task" : ` Напишите HTML-код абзаца с текстом, в котором используется ключевое слово "лучшие ноутбуки". `,
        "correctAnswer" : "<p>У нас вы найдете лучшие ноутбуки по отличным ценам.</p>"
    },
    {
        "id": 6,
        "title": "Внутренние ссылки",
        "description": "Внутренние ссылки, их значением для SEO и как правильно их использовать на сайте для улучшения навигации и поисковой оптимизации.",
        "content": `
            <p>Внутренние ссылки — это ссылки, которые ведут на страницы внутри одного и того же сайта. В отличие от внешних ссылок, которые ведут на другие сайты, внутренние ссылки помогают пользователям и поисковым системам перемещаться по вашему сайту.</p>
            <p>Использование внутренних ссылок имеет несколько преимуществ:</p>
            <ul>
                <li><strong>Улучшение навигации:</strong> Внутренние ссылки позволяют пользователям быстрее находить нужную информацию на сайте.</li>
                <li><strong>Поддержка SEO:</strong> Поисковые системы используют внутренние ссылки для индексации страниц. Правильная структура внутренних ссылок может улучшить видимость ваших страниц в поисковой выдаче.</li>
                <li><strong>Распределение ссылочного веса:</strong> Внутренние ссылки помогают передавать ссылочный вес от одной страницы к другой, что способствует улучшению позиций в поисковых системах.</li>
            </ul>

            <h2>Как правильно использовать внутренние ссылки?</h2>
            <p>Для создания внутренней ссылки используется стандартный HTML-тег <code>&lt;a&gt;</code> с атрибутом <code>href</code>, указывающим путь к странице на том же сайте. Важно использовать понятные и точные анкорные тексты, которые описывают, что можно ожидать, перейдя по ссылке.</p>
            
            <h2>Пример внутренней ссылки</h2>
            <p>Вот пример HTML-кода внутренней ссылки на страницу "О нас" с анкорным текстом "Подробнее о компании":</p>
            <pre>&lt;a href="/about"&gt;Подробнее о компании&lt;/a&gt;</pre>
            <p>В этом примере ссылка ведет на страницу "О нас", а анкорный текст сообщает пользователю, что он сможет узнать больше о компании, перейдя по ссылке.</p>
        `,
        "task" : ` Напишите HTML-код внутренней ссылки на страницу "Отзывы" (reviews) с анкорным текстом "Наши отзывы". `,
        "correctAnswer" : `<a href="/reviews">Наши отзывы</a>`
    },
    {
        "id": 7,
        "title": "Локальное SEO",
        "description": "Локальное SEO помогает вашему бизнесу отображаться в результатах поиска, когда пользователи ищут товары или услуги в конкретных географических местах.",
        "content": `
            <h2>Что такое локальное SEO?</h2>
            <p>Локальное SEO — это процесс оптимизации вашего сайта для улучшения видимости в поисковых системах по локальным запросам. Например, когда кто-то ищет "пекарня рядом" или "магазин бытовой техники в Москве". Для того чтобы ваше заведение появлялось в таких поисках, необходимо указать точную информацию о местоположении и бизнесе.</p>
            <p>Локальное SEO включает в себя:</p>
            <ul>
                <li><strong>Оптимизация для Google My Business:</strong> Это важный инструмент для локальных бизнесов, который позволяет управлять информацией о вашем предприятии, как, например, адрес, время работы и отзывы.</li>
                <li><strong>Использование микроразметки:</strong> Это формат структурированных данных, который помогает поисковым системам лучше понять информацию на странице.</li>
            </ul>

            <h2>Что такое микроразметка (Microdata)?</h2>
            <p>Микроразметка — это способ разметки данных на веб-странице с использованием тегов и атрибутов, которые помогают поисковым системам понимать контент. Одним из самых популярных стандартов микроразметки является <a href="https://schema.org" target="_blank">schema.org</a>, который поддерживает различные типы данных, включая информацию о компаниях, событиях, товарах и многом другом.</p>

            <h2>Пример микроразметки для локального бизнеса</h2>
            <p>Для организации можно использовать разметку типа <code>Organization</code>, чтобы указать информацию о компании, такую как название, адрес, телефон. Вот пример разметки для адреса и телефона компании:</p>
            <pre>
&lt;div itemscope itemtype="https://schema.org/Organization"&gt;
    &lt;span itemprop="name"&gt;Автосалон «Тачки»&lt;/span&gt;
    &lt;span itemprop="address"&gt;Москва, ул. Ленина, д. 5&lt;/span&gt;
    &lt;span itemprop="telephone"&gt;+7 495 123-45-67&lt;/span&gt;
&lt;/div&gt;</pre>
            <p>Этот код сообщает поисковым системам, что на странице содержится информация об организации "Автосалон «Тачки»" с адресом в Москве и телефоном компании.</p>
        `,
        "task" : ` Напишите микроразметку типа LocalBusiness для компании Магазин Техно. Также укажите адрес Москва, ул. Ленина, д. 5. `,
        "correctAnswer" : `<div itemscope itemtype="https://schema.org/LocalBusiness">\n<span itemprop="name">Магазин Техно</span>\n<span itemprop="address">Москва, ул. Ленина, д. 5</span>\n</div>`
    },
    {
        "id": 8,
        "title": "SEO-аналитика",
        "description": "SEO-аналитика играет важную роль в оценке эффективности ваших SEO-усилий и позволяет отслеживать источники трафика, а также поведение пользователей на вашем сайте.",
        "content": `
            <p>SEO-аналитика — это процесс измерения и анализа эффективности SEO-стратегий с целью улучшения видимости сайта в поисковых системах и увеличения органического трафика. Для того чтобы понять, какие источники приводят пользователей на ваш сайт, нужно использовать различные методы отслеживания, включая UTM-метки.</p>
            <p>Основные аспекты SEO-аналитики включают:</p>
            <ul>
                <li><strong>Использование Google Analytics:</strong> Это один из самых популярных инструментов для отслеживания трафика и анализа поведения пользователей.</li>
                <li><strong>Отслеживание источников трафика:</strong> С помощью UTM-меток можно понять, какие каналы рекламных кампаний (поисковая реклама, социальные сети, баннеры и т. д.) приводят наибольшее количество пользователей.</li>
                <li><strong>Анализ конверсий:</strong> SEO-аналитика помогает оценить, какие страницы сайта приводят к конверсиям (например, покупкам или регистрации).</li>
            </ul>

            <h2>Что такое UTM-метки?</h2>
            <p>UTM-метки (Urchin Tracking Module) — это параметры, добавляемые в URL ссылки для отслеживания эффективности рекламных кампаний. Они помогают аналитическим системам, таким как Google Analytics, собирать информацию о том, откуда пришел трафик, какие рекламные кампании и каналы наиболее эффективны.</p>

            <h2>Пример фрагмента UTM-метки</h2>
            <p>Пример UTM-метки для отслеживания рекламной кампании "Лето":</p>
            <pre>?utm_source=google&utm_medium=cpc&utm_campaign=summer</pre>
            <p>В этом примере:</p>
            <ul>
                <li><strong>utm_source=google</strong> — источник трафика, в данном случае это Google.</li>
                <li><strong>utm_medium=cpc</strong> — канал трафика, контекстная реклама (CPC — cost-per-click).</li>
                <li><strong>utm_campaign=summer</strong> — название рекламной кампании, в данном случае это кампания "Лето".</li>
            </ul>
        `,
        "task" : ` Напишите фрагмент UTM-метки для отслеживания рекламной кампании "Декабрь" (december). Источник трафика - яндекс `,
        "correctAnswer" : "?utm_source=yandex&utm_medium=cpc&utm_campaign=december"
    },
    {
        "id": 9,
        "title": "Советы и тренды SEO",
        "description": "Веб-среда постоянно меняется, и вместе с ней развиваются новые методы SEO-оптимизации. Чтобы оставаться конкурентоспособным в поисковых системах, важно следить за современными тенденциями и рекомендациями.",
        "content": `
            <p>SEO всегда было важной частью цифрового маркетинга, но с каждым годом появляются новые аспекты, которые необходимо учитывать для успешного продвижения. Сегодня, когда технологии быстро развиваются, а потребности пользователей меняются, SEO становится более сложным и многогранным процессом.</p>
            <p>Некоторые из актуальных трендов SEO, на которые стоит обратить внимание в 2024 году:</p>
            <ul>
                <li><strong>Мобильная оптимизация:</strong> В последние годы мобильные устройства стали основными источниками трафика. Более 60% пользователей заходят на сайты с мобильных устройств, и поисковые системы, такие как Google, учитывают это при ранжировании сайтов. Сайт должен быть адаптивным, быстро загружаться и предоставлять хороший опыт пользователям на смартфонах и планшетах.</li>
                <li><strong>Голосовой поиск:</strong> С ростом популярности голосовых ассистентов (например, Google Assistant, Siri, Alexa) голосовой поиск становится важным фактором для SEO. Пользователи, делая запросы через голосовые устройства, часто используют более длинные, разговорные фразы, что требует оптимизации контента для естественного языка. Ответы на такие запросы должны быть краткими и точными.</li>
                <li><strong>Использование структурированных данных:</strong> Структурированные данные помогают поисковым системам лучше понять содержание страницы. Это позволяет улучшить видимость сайта в поисковых результатах, предоставляя дополнительные элементы, такие как рейтинги, отзывы или карты. Применение схемы <a href="https://schema.org" target="_blank">schema.org</a> помогает структурировать данные о продуктах, событиях, статьях и других элементах.</li>
                <li><strong>Оптимизация скорости загрузки страницы:</strong> Время загрузки сайта стало одним из ключевых факторов для поисковых систем. Быстро загружающиеся страницы предоставляют лучший пользовательский опыт и получают более высокие позиции в поисковой выдаче. Инструменты, такие как Google PageSpeed Insights, помогают анализировать скорость и находить способы ускорения работы сайта.</li>
                <li><strong>Видеоконтент:</strong> Видео-контент продолжает набирать популярность и оказывает значительное влияние на SEO. Google учитывает поведение пользователей, а видео, размещенные на сайте, могут повысить вовлеченность, время на сайте и снизить показатель отказов. Видео также позволяет получать дополнительное отображение в результатах поиска.</li>
                <li><strong>SEO для искусственного интеллекта (AI):</strong> Современные поисковые системы, такие как Google, используют искусственный интеллект и машинное обучение для улучшения результатов поиска. Важно учитывать, как алгоритмы Google оценивают и ранжируют страницы, а также как AI может изменять подходы к поисковому запросу.</li>
            </ul>

            <h2>Как голосовой поиск меняет SEO?</h2>
            <p>Голосовой поиск — это процесс поиска информации через голосовые команды, такие как запросы, выполняемые с помощью Google Assistant, Siri или Alexa. Эта технология активно развивается, и пользователи часто задают вопросы в виде разговорных фраз, а не коротких ключевых слов. Например, вместо того чтобы искать "пекарня рядом", люди могут сказать "Где находится ближайшая пекарня?".</p>
            <p>Чтобы оптимизировать контент для голосового поиска, следует учитывать несколько аспектов:</p>
            <ul>
                <li><strong>Естественный язык:</strong> Создавайте контент, который будет максимально естественно звучать в разговорной форме. Часто голосовые запросы длиннее и содержат вопросы, такие как "Что такое...?" или "Как сделать...?"</li>
                <li><strong>Прямой ответ:</strong> Голосовые устройства часто предоставляют короткие и точные ответы. Стремитесь к созданию кратких и емких текстов, которые отвечают на вопросы пользователей, с указанием фактов и цифр.</li>
                <li><strong>Оптимизация для локального SEO:</strong> Многие голосовые запросы связаны с местоположением (например, "где ближайший ресторан?"). Поэтому важно указать точные данные о местоположении и оптимизировать сайт для локальных запросов.</li>
            </ul>
            
            <div style="text-align: center; margin-top: 20px; font-size: 18px; font-weight: bold;">
                <p>На этом уроки окончены, спасибо за прохождение!</p>
            </div>
        `,
        "task" : ``,
        "correctAnswer" : ""
    }
];

export default function LessonPage({ params }: { params: Promise<Params> }) {
  const paramsResolved = React.use(params);
  const id = Number(paramsResolved.id);

  const [lesson, setLesson] = useState<Lesson | null>(null);
  const [progress, setProgress] = useState(0);
  const [userAnswer, setUserAnswer] = useState("");
  const [message, setMessage] = useState("");

  useEffect(() => {
    if (!id) return;
    const lessonId = Number(id);
    const foundLesson = lessonsData.find((l) => l.id === lessonId) || null;
    setLesson(foundLesson);

    const savedProgress = Cookies.get(`lesson_${lessonId}_progress`) || "0";
    setProgress(Number(savedProgress));
  }, [id]);

  const [progressMap, setProgressMap] = useState<{ [key: number]: number }>({});

  useEffect(() => {
    const map: { [key: number]: number } = {};
    lessonsData.forEach((l) => {
      const val = Cookies.get(`lesson_${l.id}_progress`) || "0";
      map[l.id] = Number(val);
    });
    setProgressMap(map);
  }, []);

  if (!lesson) return <div>Урок не найден</div>;

  function checkAnswer() {
    if (progress >= 100) {
      setMessage("Урок уже пройден!");
      return;
    }

    if (userAnswer.trim() === lesson?.correctAnswer) {
      const newProgress = 100;
      setProgress(newProgress);
      Cookies.set(`lesson_${lesson.id}_progress`, String(newProgress), { expires: 30 });
      setMessage("Правильно! Поздравляем, урок завершён.");
      setUserAnswer("");
    } else {
      setMessage("Неверно! Попробуйте еще раз.");
    }
  }

  return (
    <>
    <header className="bg-green-500 text-white py-5 shadow-lg mb-5">
      <h1 className="text-center text-2xl font-bold">
        Основы SEO
      </h1>
    </header>
    <main className="min-h-screen p-6 bg-[#f4f4f4] text-gray-800 max-w-8xl mx-auto">
      <div className="min-h-screen p-6 bg-white text-gray-800 max-w-6xl mx-auto flex gap-6">
        <aside className="w-64 hidden md:block  p-5 border-r-2 border-[#ddd] mr-5">
          <h3 className="text-lg font-bold mb-4">Все уроки</h3>
          <ul className="space-y-2 list-none p-0 m-0">
            {lessonsData.map((l) => (
              <li key={l.id}>
                <Link
                  href={`/lesson/${l.id}`}
                  className="block text-gray-800 font-bold no-underline transition-colors duration-300 hover:text-[#4CAF50]"
                >
                  Урок {l.id}: {l.title}
                </Link>
                <div className="text-sm text-gray-500">
                  Прогресс: {progressMap[l.id] || 0}%
                </div>
              </li>
            ))}
          </ul>
        </aside>

        <div className="flex-1">
          <header className="mb-8">
            <Link href="/"className="text-blue-600 hover:underline">
              ← Вернуться на главную
            </Link>
            <h1 className="text-3xl font-bold mt-4">Урок {lesson.id}: {lesson.title}</h1>
            <p className="text-gray-600 mt-2">{lesson.description}</p>
          </header>
          <article className="prose max-w-none mb-6" dangerouslySetInnerHTML={{ __html: lesson.content }}></article>
          {lesson.task !== "" ? (
            <>
              <section className="mb-6">
                <h2 className="text-xl font-semibold mb-2">Задание:</h2>
                <p>{lesson.task}</p>
                <textarea
                  className="w-full p-2 border rounded mb-2"
                  rows={4}
                  value={userAnswer}
                  onChange={(e) => setUserAnswer(e.target.value)}
                  placeholder="Напишите ответ здесь"
                  disabled={progress >= 100}
                />
                <button
                  onClick={checkAnswer}
                  className="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-700 disabled:opacity-50"
                  disabled={progress >= 100}
                >
                  Проверить
                </button>
                {message && <p className="mt-2 text-red-600">{message}</p>}
              </section>

              <section>
                <h3 className="mb-2">Прогресс:</h3>
                <div className="relative w-full h-6 bg-gray-200 rounded">
                  <div
                    className="absolute top-0 left-0 h-full bg-green-500 rounded"
                    style={{ width: `${progress}%` }}
                  ></div>
                  <div className="absolute inset-0 text-center text-sm leading-6">
                    {progress}%
                  </div>
                </div>
              </section>
            </>
          ) : ""}
        </div>
      </div>
    </main>
    </>
  );
}